<template>
  <!-- <div id="wrapper"> -->
  <!-- <header-bar> </header-bar> -->
  <!-- <el-container> -->
  <el-main>
    <div class="logo-update-div">
      <svg
        t="1625463839499"
        class="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="3687"
        width="100"
        height="100"
      >
        <path
          d="M910.3 833.9H173.1c-27.4 0-49.8-22.3-49.8-49.8V287.3c0-27.4 22.3-49.8 49.8-49.8h737.3c27.4 0 49.8 22.3 49.8 49.8v496.8c-0.1 27.5-22.4 49.8-49.9 49.8z"
          fill="#A7B8C6"
          p-id="3688"
        ></path>
        <path
          d="M272.5 203.7H118.8c-22.8 0-41.3 18.5-41.3 41.3v513.7c0 22.8 18.5 41.3 41.3 41.3H873c22.8 0 41.3-18.5 41.3-41.3V245c0-22.8-18.5-41.3-41.3-41.3H272.5z"
          fill="#1D3E64"
          p-id="3689"
        ></path>
        <path
          d="M914.3 757.8V464c-8.1-2.8-16.7-4.4-25.7-4.4-42.7 0-77.4 34.7-77.4 77.4 0 12.9 3.2 25 8.7 35.7-0.9 1.4-1.7 2.9-2.5 4.4-9.3-3.9-19.5-6.1-30.2-6.1-39.6 0-72.2 29.7-76.8 68-7.5-2.4-15.4-3.7-23.7-3.7-19.2 0-36.7 7-50.3 18.6-13.5-11.6-31.1-18.6-50.3-18.6-20.2 0-38.6 7.7-52.3 20.4-13.8-12.7-32.2-20.4-52.3-20.4-11.5 0-22.4 2.5-32.2 7-14.2-17.6-35.9-28.8-60.3-28.8-23.5 0-44.6 10.5-58.8 27.1-12.6-9-28.1-14.3-44.8-14.3-3.5 0-7 0.3-10.4 0.7-13.4-23.1-38.4-38.6-67-38.6-4.4 0-8.7 0.4-12.9 1.1-5.8-17.6-17.7-32.5-33.2-42 0.5-3.7 0.8-7.5 0.8-11.4 0-41.4-32.5-75.2-73.4-77.3v299h825z"
          fill="#F1BA38"
          p-id="3690"
        ></path>
        <path
          d="M81.6 722.1h-4.1V800h823.2V579.8c-4.9-1-9.9-1.5-15.1-1.5-29.6 0-55.3 16.6-68.3 41-9.3-3.9-19.5-6.1-30.2-6.1-39.6 0-72.2 29.7-76.8 68-7.5-2.4-15.4-3.7-23.7-3.7-19.2 0-36.7 7-50.3 18.6-13.5-11.6-31.1-18.6-50.3-18.6-20.2 0-38.6 7.7-52.3 20.4-13.8-12.7-32.2-20.4-52.3-20.4-11.5 0-22.4 2.5-32.2 7-14.2-17.6-35.9-28.8-60.3-28.8-23.5 0-44.6 10.5-58.8 27.1-12.6-9-28.1-14.3-44.8-14.3-3.5 0-7 0.3-10.4 0.7-13.4-23.1-38.4-38.6-67-38.6-4.4 0-8.7 0.4-12.9 1.1-5.8-17.6-17.7-32.5-33.2-42 0.5-3.7 0.8-7.5 0.8-11.4 0-42.7-34.7-77.4-77.4-77.4-2.6 0-5.3 0.1-7.8 0.4v218.1l4.2 2.7z"
          fill="#F8F1D8"
          p-id="3691"
        ></path>
        <path
          d="M872.9 813.6H118.8c-30.3 0-54.9-24.6-54.9-54.9V245c0-30.3 24.6-54.9 54.9-54.9h754.1c30.3 0 54.9 24.6 54.9 54.9v513.7c0 30.3-24.6 54.9-54.9 54.9zM118.8 217.3c-15.3 0-27.7 12.4-27.7 27.7v513.7c0 15.3 12.4 27.7 27.7 27.7h754.1c15.3 0 27.7-12.4 27.7-27.7V245c0-15.3-12.4-27.7-27.7-27.7H118.8z"
          fill="#3E3A39"
          p-id="3692"
        ></path>
        <path
          d="M476.8 527.3h67.4v92.1h-67.4z"
          fill="#F1BA38"
          p-id="3693"
        ></path>
        <path
          d="M476.8 527.3s-6.8 89-36.2 118.4c-29.4 29.4 153.8 9 153.8 9s-50.2-57.4-50.2-127.4"
          fill="#F1BA38"
          p-id="3694"
        ></path>
        <path
          d="M487.4 527.3s-5 134.2-26.5 163.6 112.5 9 112.5 9-36.7-102.6-36.7-172.7"
          fill="#F8F1D8"
          p-id="3695"
        ></path>
        <path
          d="M529.5 488.9c31.4 3.8 59.8 61 59.8 61 1.9 1.9 5.2 0.6 5.2-2.1v-65.1c0-9.6-5.3-18.4-13.7-23L535 435c-2.5-1.3-5.5 0.5-5.5 3.3v50.6z m-41.6 0c-31.4 3.8-59.8 61-59.8 61-1.9 1.9-5.2 0.6-5.2-2.1v-65.1c0-9.6 5.3-18.4 13.7-23l45.8-24.7c2.5-1.3 5.5 0.5 5.5 3.3v50.6z"
          fill="#D75655"
          p-id="3696"
        ></path>
        <path
          d="M550.2 339.7h-78c-7.3 22.5-11.7 51.4-11.7 82.9 0 36.6 5.9 69.7 15.5 93.3h70.4c9.6-23.6 15.5-56.6 15.5-93.3 0.1-31.5-4.3-60.4-11.7-82.9z m-39.3 68.9c-10.2 0-18.5-8.3-18.5-18.5s8.3-18.5 18.5-18.5 18.5 8.3 18.5 18.5c0.1 10.2-8.2 18.5-18.5 18.5z"
          fill="#F1F4F1"
          p-id="3697"
        ></path>
        <path
          d="M511.3 292.9c-15.7 0-29.7 18.2-39 46.8h78c-9.4-28.6-23.4-46.8-39-46.8z"
          fill="#CD564A"
          p-id="3698"
        ></path>
        <path
          d="M515.1 582h-7.7c-0.7 0-1.3-0.6-1.3-1.3v-113c0-0.7 0.6-1.3 1.3-1.3h7.7c0.7 0 1.3 0.6 1.3 1.3v113c0.1 0.7-0.5 1.3-1.3 1.3z"
          fill="#D75655"
          p-id="3699"
        ></path>
        <path
          d="M480.1 339.7c8.5-26.2 21-43.6 35.1-46.4-1.3-0.3-2.6-0.4-3.9-0.4-15.7 0-29.7 18.2-39 46.8-7.3 22.5-11.7 51.4-11.7 82.9 0 36.6 5.9 69.7 15.5 93.3h7.8c-9.6-23.6-15.5-56.6-15.5-93.3 0-31.5 4.4-60.4 11.7-82.9z"
          fill="#F1F4F1"
          p-id="3700"
        ></path>
        <path
          d="M550.2 339.7c-9.3-28.6-23.3-46.8-39-46.8-1.3 0-2.6 0.2-3.9 0.4 14.1 2.7 26.6 20.2 35.1 46.4 7.3 22.5 11.7 51.4 11.7 82.9 0 36.6-5.9 69.7-15.5 93.3h7.8c9.6-23.6 15.5-56.6 15.5-93.3 0.1-31.5-4.3-60.4-11.7-82.9z"
          fill="#FFFFFF"
          p-id="3701"
        ></path>
      </svg>
    </div>
    <el-card class="box-card">
      <div slot="header" class="clearfix">
        <span style="font-size: 20px">{{ $t("lang.portSelect") }}</span>
        <el-button
          style="float: right; padding: 3px 0; font-size: 20px"
          type="text"
          @click="connectSerialPort"
          >{{
            isConnected
              ? $t("lang.disconnSerialport")
              : $t("lang.connSerialport")
          }}</el-button
        >
      </div>
      <el-select
        v-model="value"
        :placeholder="$t('lang.pleaseSelectPort')"
        style="display: block"
        @visible-change="listSerialPort"
      >
        <el-option
          v-for="item in options"
          :key="item.key"
          :label="item.value"
          :value="item.value"
        >
        </el-option>
      </el-select>
      <div class="into-update-div">
        <svg
          @click="toMainPage"
          t="1618386404529"
          class="icon"
          viewBox="0 0 1024 1024"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg"
          p-id="4395"
          width="64"
          height="64"
          xmlns:xlink="http://www.w3.org/1999/xlink"
        >
          <path
            d="M64.1 512.1c0 247.4 200.6 448 448 448s448-200.6 448-448-200.6-448-448-448-448 200.6-448 448z m526.2 0.1L431.5 353.3c-11.6-11.6-11.6-30.6 0-42.2s30.6-11.6 42.2 0l179.9 180c11.6 11.6 11.6 30.6 0 42.2L474.9 712.1c-5.9 5.8-13.5 8.7-21.1 8.7-7.6 0-15.3-2.9-21.1-8.7-11.6-11.6-11.6-30.6 0-42.2l157.6-157.7z"
            fill="#1296db"
            p-id="4396"
          ></path>
        </svg>
      </div>
    </el-card>
  </el-main>
  <!-- </el-container> -->
  <!-- </div> -->
</template>
<script>
import Vue from "vue";
export default {
  name: "landing-page",
  data() {
    return {
      value: "",
      options: [],
      isConnected: false,
    };
  },
  mounted() {
    if (Vue.serialport.getIntance()) {
      this.isConnected = true;
      this.value = Vue.serialport.getIntance().path;
    }
    Vue.serialport.on("onError", this.onSerialPortError);
    Vue.serialport.on("onConnected", this.onSerialPortConnected);
    Vue.serialport.on("onClose", this.onSerialPortClose);
  },
  destroyed() {
    Vue.serialport.remove("onError", this.onSerialPortError);
    Vue.serialport.remove("onConnected", this.onSerialPortConnected);
    Vue.serialport.remove("onClose", this.onSerialPortClose);
  },
  methods: {
    listSerialPort(visible) {
      if (visible) {
        Vue.serialport.listSerialPort().then((data) => {
          console.log(data);
          this.options = data;
        });
      }
    },
    connectSerialPort() {
      if (!this.value) {
        this.$alert(
          this.$t("lang.notYetSelectPort"),
          this.$t("lang.notifyTitle")
        );
        return;
      }
      if (!this.isConnected) {
        Vue.serialport.initSerialPort(this.value);
      } else {
        Vue.serialport.closeSerialPort();
      }
    },
    onSerialPortError(error) {
      console.log(error);
    },
    onSerialPortConnected(error) {
      if (!error) {
        console.log("---连接成功---");
        this.isConnected = true;
      } else {
        this.$alert(error, this.$t("lang.serialportConnTitle"));
      }
    },
    onSerialPortClose(error) {
      if (!error) {
        console.log("---连接已断开成功---");
        this.isConnected = false;
      }
    },
    toMainPage() {
      if (this.isConnected) {
        console.log("点击了进入主界面的按钮，可以自定义跳转页面");
        // this.$router.push({
        //   path: "/main-page",
        // });
      } else {
        this.$alert(
          this.$t("lang.cannotIntoUpgrade"),
          this.$t("lang.serialportConnTitle")
        );
      }
    },
  },
};
</script>
<style scoped>
.text {
  font-size: 14px;
}

.item {
  margin-bottom: 18px;
}

.clearfix:before,
.clearfix:after {
  display: table;
  content: "";
}
.clearfix:after {
  clear: both;
}

.box-card {
  width: 100%;
  text-align: center;
  /* margin-top: 40px; */
}
.logo-update-div {
  text-align: center;
  /* text-align:center;   */
  margin: 0 auto;
  padding: 0;
  clear: both;
}
.svg-div {
  margin-bottom: 5px;
  text-align: top;
  padding: 0;

  display: inline-block;
  _display: inline;
  *display: inline;
  zoom: 1;
}
.into-update-div {
  width: 100%;
  text-align: center;
  margin-top: 20px;
}
.into-update-div svg:hover path {
  fill: aqua;
}
.el-input__inner {
  font-size: 20px !important;
}
</style>
